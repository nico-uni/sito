<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Miniature Fantasy Shop</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    body {
      background: linear-gradient(135deg, #2c3e50 0%, #4ca1af 100%);
      color: #f0e6d2;
      font-family: 'Georgia', serif;
    }
    header, footer {
      text-align: center;
      padding: 1rem;
      background-color: rgba(44, 62, 80, 0.85);
      box-shadow: 0 0 10px #222;
    }
    h1, h2, h4 {
      color: #f9d71c;
      text-shadow: 1px 1px 4px #000;
    }
    /* Cards container */
    #products {
      margin-top: 2rem;
      margin-bottom: 3rem;
    }
    .card {
      background-color: rgba(44, 62, 80, 0.85);
      border: 2px solid #f9d71c;
      color: #f0e6d2;
      box-shadow: 0 0 10px #d4af37;
      cursor: pointer;
      transition: transform 0.2s ease;
    }
    .card:hover {
      transform: scale(1.05);
      box-shadow: 0 0 15px #f9d71c;
    }
    .card-img-top {
      border-bottom: 2px solid #f9d71c;
    }
    .btn-warning {
      background-color: #f9d71c;
      border-color: #d4af37;
      color: #2c3e50;
      font-weight: bold;
    }
    .btn-warning:hover {
      background-color: #d4af37;
      color: #f0e6d2;
    }
    .btn-danger {
      background-color: #a83232;
      border-color: #7a2525;
    }
    .btn-danger:hover {
      background-color: #7a2525;
    }
    .btn-success {
      background-color: #3a6b35;
      border-color: #2d4d27;
    }
    .btn-success:hover {
      background-color: #2d4d27;
    }
    table {
      background-color: rgba(44, 62, 80, 0.75);
      color: #f0e6d2;
    }
    /* Modal overrides */
    .modal-content {
      background-color: rgba(44, 62, 80, 0.95);
      color: #f0e6d2;
      border: 2px solid #f9d71c;
      box-shadow: 0 0 20px #d4af37;
    }
    .modal-header, .modal-footer {
      border-color: #f9d71c;
    }
    .form-control, .form-check-label a {
      background: rgba(255,255,255,0.1);
      color: #f0e6d2;
    }
    .form-control:focus {
      background: rgba(255,255,255,0.15);
      color: #f9d71c;
      border-color: #f9d71c;
      box-shadow: 0 0 5px #f9d71c;
    }
    .form-check-label a:hover {
      color: #d4af37;
    }
  </style>
</head>
<body>
  <header>
    <h1>Miniature Fantasy Shop</h1>
  </header>

  <main class="container">

    <!-- Sezione prodotti 2 file x 3 colonne -->
    <section id="products" class="row row-cols-1 row-cols-md-3 g-4">
      <!-- Cards generate dinamicamente da JS -->
    </section>

    <!-- Carrello -->
    <section id="cart" class="mt-5">
      <h2>Carrello</h2>
      <table class="table table-striped">
        <thead>
          <tr>
            <th>Nome</th>
            <th>Prezzo (€)</th>
            <th>Quantità</th>
            <th>Totale</th>
            <th>Azione</th>
          </tr>
        </thead>
        <tbody id="cart-items"></tbody>
      </table>
      <h4>Totale carrello: €<span id="cart-total">0</span></h4>
      <button class="btn btn-warning" onclick="clearCart()">Svuota Carrello</button>
      <button class="btn btn-primary mt-3" data-bs-toggle="modal" data-bs-target="#checkoutModal" onclick="showCheckout()" >Vai al Checkout</button>
    </section>

  </main>

  <footer class="mt-5">
    Miniature Fantasy © 2025 - Tutti i diritti riservati
  </footer>

  <!-- Modal per dettagli prodotto -->
  <div class="modal fade" id="productDetailModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="detail-title"></h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Chiudi"></button>
        </div>
        <div class="modal-body d-flex flex-column flex-md-row gap-4">
          <img id="detail-image" src="" alt="" class="img-fluid col-md-5 rounded" />
          <div class="col-md-7">
            <p id="detail-description"></p>
            <h4>Prezzo: €<span id="detail-price"></span></h4>
            <button class="btn btn-warning" id="add-to-cart-btn">Aggiungi al carrello</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal Checkout -->
  <div class="modal fade" id="checkoutModal" tabindex="-1" aria-labelledby="checkoutModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content" >
        <div class="modal-header">
          <h5 class="modal-title" id="checkoutModalLabel">Checkout</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Chiudi"></button>
        </div>
        <div class="modal-body">
          <form id="checkout-form">
            <div class="mb-3">
              <label for="nome" class="form-label">Nome</label>
              <input type="text" class="form-control" id="nome" required />
            </div>
            <div class="mb-3">
              <label for="indirizzo" class="form-label">Indirizzo</label>
              <input type="text" class="form-control" id="indirizzo" required />
            </div>
            <div class="mb-3">
              <label for="carta" class="form-label">Carta di Credito</label>
              <input type="text" class="form-control" id="carta" required />
            </div>
            <div class="form-check mb-3">
              <input class="form-check-input" type="checkbox" id="accettaTermini" required />
              <label class="form-check-label" for="accettaTermini">
                Accetto i <a href="#" style="color:#f9d71c;">termini e condizioni</a>
              </label>
            </div>
            <p class="fw-bold">Totale da pagare: €<span id="checkout-total">0</span></p>
            <button type="submit" class="btn btn-success">Completa Ordine</button>
          </form>
          <div id="checkout-message" class="mt-3"></div>
        </div>
      </div>
    </div>
  </div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
  // Dati miniature con immagini pubbliche e descrizioni approfondite
  const products = [
    {
      id: 1,
      name: "Miniatura Guerriero",
      price: 14.99,
      img: "https://cdn.pixabay.com/photo/2014/12/21/23/28/miniature-575235_960_720.jpg",
      description: "Miniatura di un guerriero valoroso, armato di spada e scudo, ideale per giochi di ruolo fantasy. Dettagli finemente scolpiti e perfetta per pittura personalizzata."
    },
    {
      id: 2,
      name: "Miniatura Mago",
      price: 19.99,
      img: "https://cdn.pixabay.com/photo/2019/12/16/10/34/fantasy-4696603_960_720.jpg",
      description: "Miniatura di un mago antico con bastone magico e mantello. Ottima per campagne fantasy, dotata di dettagli magici e simboli arcani."
    },
    {
      id: 3,
      name: "Miniatura Arciere",
      price: 12.49,
      img: "https://cdn.pixabay.com/photo/2016/10/18/17/05/fantasy-1753484_960_720.jpg",
      description: "Miniatura di un arciere agile con arco lungo. Perfetta per scenari di combattimento a distanza, dettagliata e pronta per la pittura."
    },
    {
      id: 4,
      name: "Miniatura Paladino",
      price: 21.50,
      img: "https://cdn.pixabay.com/photo/2020/05/14/14/45/fantasy-5174406_960_720.jpg",
      description: "Miniatura di un paladino sacro, armato di martello e scudo, simbolo di giustizia e protezione. Scultura raffinata per collezionisti."
    },
    {
      id: 5,
      name: "Miniatura Ladro",
      price: 11.00,
      img: "https://cdn.pixabay.com/photo/2019/08/25/16/34/fantasy-4421826_960_720.jpg",
      description: "Miniatura di un ladro furtivo con pugnali doppi. Ideale per avventure stealth e rapidi assalti, con dettagli accurati."
    },
    {
      id: 6,
      name: "Miniatura Drago",
      price: 29.99,
      img: "https://cdn.pixabay.com/photo/2017/10/31/13/04/fantasy-2908888_960_720.jpg",
      description: "Miniatura di un drago possente con ali spiegate, perfetta come pezzo centrale per battaglie epiche o come modello da collezione."
    },
  ];

  let cart = [];

  const productsContainer = document.getElementById("products");

  // Funzione per creare le card dei prodotti
  function renderProducts() {
    productsContainer.innerHTML = "";
    products.forEach(product => {
      const cardCol = document.createElement("div");
      cardCol.className = "col";

      cardCol.innerHTML = `
        <div class="card h-100" role="button" tabindex="0" aria-label="Visualizza dettagli di ${product.name}">
          <img src="${product.img}" class="card-img-top" alt="${product.name}" />
          <div class="card-body d-flex flex-column">
            <h5 class="card-title">${product.name}</h5>
            <p class="card-text flex-grow-1">Prezzo: €${product.price.toFixed(2)}</p>
            <button class="btn btn-warning mt-auto" onclick="openProductModal(${product.id})">Dettagli</button>
          </div>
        </div>
      `;
      productsContainer.appendChild(cardCol);
    });
  }

  // Apri il popup dettagli prodotto
  function openProductModal(id) {
    const product = products.find(p => p.id === id);
    if (!product) return;

    document.getElementById("detail-title").textContent = product.name;
    document.getElementById("detail-image").src = product.img;
    document.getElementById("detail-image").alt = product.name;
    document.getElementById("detail-description").textContent = product.description;
    document.getElementById("detail-price").textContent = product.price.toFixed(2);

    const addBtn = document.getElementById("add-to-cart-btn");
    addBtn.onclick = () => {
      addToCart(product.id);
      const modal = bootstrap.Modal.getInstance(document.getElementById("productDetailModal"));
      modal.hide();
    };

    const productModal = new bootstrap.Modal(document.getElementById("productDetailModal"));
    productModal.show();
  }

  // Aggiungi prodotto al carrello, se già presente incrementa quantità
  function addToCart(productId) {
    const product = products.find(p => p.id === productId);
    if (!product) return;

    const cartItem = cart.find(item => item.id === productId);
    if (cartItem) {
      cartItem.quantity++;
    } else {
      cart.push({ id: product.id, name: product.name, price: product.price, quantity: 1 });
    }
    updateCart();
  }

  // Aggiorna visualizzazione carrello
  function updateCart() {
    const cartItems = document.getElementById("cart-items");
    cartItems.innerHTML = "";
    let total = 0;

    cart.forEach((item, index) => {
      const subtotal = item.price * item.quantity;
      total += subtotal;

      const row = document.createElement("tr");
      row.innerHTML = `
        <td>${item.name}</td>
        <td>€${item.price.toFixed(2)}</td>
        <td>
          <input
            type="number"
            min="1"
            value="${item.quantity}"
            onchange="updateQuantity(${index}, this.value)"
            class="form-control form-control-sm"
            style="width: 70px;"
            aria-label="Quantità per ${item.name}"
          />
        </td>
        <td>€${subtotal.toFixed(2)}</td>
        <td>
          <button class="btn btn-danger btn-sm" onclick="removeFromCart(${index})" aria-label="Rimuovi ${item.name} dal carrello">Rimuovi</button>
        </td>
      `;
      cartItems.appendChild(row);
    });
    document.getElementById("cart-total").textContent = total.toFixed(2);
    document.getElementById("checkout-total").textContent = total.toFixed(2);
  }

  function updateQuantity(index, quantity) {
    const q = parseInt(quantity);
    if (q > 0) {
      cart[index].quantity = q;
      updateCart();
    }
  }

  function removeFromCart(index) {
    cart.splice(index, 1);
    updateCart();
  }

  function clearCart() {
    cart = [];
    updateCart();
  }

  function showCheckout() {
    const total = cart.reduce((sum, item) => sum + item.price * item.quantity, 0);
    document.getElementById("checkout-total").textContent = total.toFixed(2);
    document.getElementById("checkout-message").textContent = "";
  }

  // Gestione submit del form di checkout
  document.getElementById("checkout-form").addEventListener("submit", function (e) {
    e.preventDefault();
    if (cart.length === 0) {
      alert("Il carrello è vuoto!");
      return;
    }
    this.reset();
    cart = [];
    updateCart();
    document.getElementById("checkout-message").textContent = "Ordine completato con successo! Grazie per il tuo acquisto.";
    const modal = bootstrap.Modal.getInstance(document.getElementById("checkoutModal"));
    // chiude automaticamente dopo 3 secondi
    setTimeout(() => modal.hide(), 3000);
  });

  // Inizializza pagina
  renderProducts();
  updateCart();
</script>

</body>
</html>
